@using CleanArchitecture.Blazor.Application.Features.Documents.Commands.AddEdit
@using CleanArchitecture.Blazor.Application.Features.Documents.Commands.Upload
@using CleanArchitecture.Blazor.Server.UI.Services.JsInterop
@using CleanArchitecture.Blazor.Domain.Enums

@inherits MudComponentBase
@inject IStringLocalizer<Documents> L
<MudDialog>
    <DialogContent>
        @if (_uploadedFiles.Any())
        {
            <div class="d-flex flex-column flex-grow-1">
                @foreach (var item in _uploadedFiles)
                {
                    <MudGrid Spacing="1">
                        <MudItem xs="4" Class="align-self-center">
                            <MudText Typo="MudBlazor.Typo.body2" Inline="false" Style="text-overflow:ellipsis;overflow: hidden;">@item.FileName</MudText>
                        </MudItem>
                        <MudItem xs="5">
                            <MudProgressLinear Color="MudBlazor.Color.Success" Value="@item.UploadedBytes" Max="@item.Size" Class="my-7" />
                        </MudItem>
                        <MudItem xs="3" Class="align-self-center justify-end">
                            <MudText Typo="MudBlazor.Typo.body2" Style="float: right;">(@FormatBytes(item.UploadedBytes) / @FormatBytes(item.Size))</MudText>
                        </MudItem>
                    </MudGrid>
                }
            </div>
        }
        else
        {
            <MudAlert Severity="MudBlazor.Severity.Info"> @L["Please click [Choose Files] button to upload your photo."]</MudAlert>
        }
    </DialogContent>
    <DialogActions>
 
        <MudButton Variant="Variant.Filled" Color="MudBlazor.Color.Secondary" StartIcon="@Icons.Material.Filled.Clear" Disabled="@(!_uploadedFiles.Any())" OnClick="Clear">@ConstantString.Clear</MudButton>
        <MudFileUpload T="IReadOnlyList<IBrowserFile>" Accept=".jpg, .jpeg, .png, .webp" FilesChanged="LoadFiles" Style="margin-top:0px" >
            <ButtonTemplate>
                <MudButton Variant="Variant.Filled" HtmlTag="label"
                               Icon="@Icons.Material.Filled.AttachFile"
                               for="@context">
                    @L["Choose files"]
                </MudButton>
            </ButtonTemplate>
        </MudFileUpload>

        <MudLoadingButton Loading="@_processing" Disabled="@(!_uploadedFiles.Any())" Variant="Variant.Filled" OnClick="Submit">@ConstantString.Submit</MudLoadingButton>
        
    </DialogActions>
</MudDialog>


